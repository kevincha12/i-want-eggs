<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Address Search</title>
  <!-- Load the Google Maps API with the Places library -->
  <script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}&libraries=places"></script>
  <script>
    var selectedLat = null;
    var selectedLng = null;

    function initialize() {
      var input = document.getElementById('address');
      var autocomplete = new google.maps.places.Autocomplete(input, { types: ['geocode'] });

      autocomplete.addListener('place_changed', function() {
        var place = autocomplete.getPlace();
        if (!place.geometry) {
          console.log("No details available for input: '" + place.name + "'");
          return;
        }
        selectedLat = place.geometry.location.lat();
        selectedLng = place.geometry.location.lng();
        console.log('Selected place:', place);
        console.log('Latitude:', selectedLat, 'Longitude:', selectedLng);
      });
    }

    function displayCoords() {
      var coordsDiv = document.getElementById('coords');
      if (selectedLat && selectedLng) {
        coordsDiv.innerHTML = "<p>Latitude: " + selectedLat + "</p><p>Longitude: " + selectedLng + "</p>";
        // Redirect to the map page with coordinates as query parameters
        window.location.href = "/map/?lat=" + selectedLat + "&lng=" + selectedLng;
      } else {
        coordsDiv.innerHTML = "<p>No coordinates available. Please select an address.</p>";
      }
    }

    // Initialize autocomplete when the window loads
    google.maps.event.addDomListener(window, 'load', initialize);
  </script>
</head>
<body>
  <h3>Search for an Address</h3>
  <input id="address" type="text" placeholder="Enter an address" style="width: 300px; height: 30px; font-size: 16px;">
  <br><br>
  <button onclick="displayCoords()">Show Coordinates and View Map</button>
  <div id="coords" style="margin-top:20px; font-size:16px;"></div>
</body>
</html>
